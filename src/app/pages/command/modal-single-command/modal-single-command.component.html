<form [formGroup]="fg" (submit)="fg.valid && onSubmit()">
  <h4 mat-dialog-title>Création commande</h4>
  <ng-container mat-dialog-content>
    <h6 class="mb-3">Information sur le client</h6>
    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="client_lastname">Nom du client</label>
          <input
            type="text"
            class="form-control"
            id="client_lastname"
            placeholder="Nom du client"
            formControlName="client_lastname"
            [ngClass]="{'input-danger': fg.get('client_lastname').invalid && fg.get('client_lastname').touched}"
          >
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="client_firstname">Prénom du client</label>
          <input
            type="text"
            class="form-control"
            id="client_firstname"
            placeholder="Prénom du client"
            formControlName="client_firstname"
            [ngClass]="{'input-danger': fg.get('client_firstname').invalid && fg.get('client_firstname').touched}"
          >
        </div>
      </div>

      <div class="col-md-12">
        <div class="form-group">
          <label for="client_contact">Contact du client</label>
          <input
            type="text"
            class="form-control"
            id="client_contact"
            placeholder="Contact du client"
            formControlName="client_contact"
            [ngClass]="{'input-danger': fg.get('client_contact').invalid && fg.get('client_contact').touched}"
          >
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="command_date_livraison">Date de livraison</label>
          <input
            type="date"
            class="form-control"
            id="command_date_livraison"
            placeholder="Date de livraison"
            formControlName="command_date_livraison"
            [ngClass]="{'input-danger': fg.get('command_date_livraison').invalid && fg.get('command_date_livraison').touched}"
          >
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="command_evenement">Évènement</label>
          <input
            type="text"
            class="form-control"
            id="command_evenement"
            placeholder="Évènement"
            formControlName="command_evenement"
            [ngClass]="{'input-danger': fg.get('command_evenement').invalid && fg.get('command_evenement').touched}"
          >
        </div>
      </div>

      <div class="col-md-12 mt-3">
        <div class="row">
          <h6 class="col-md-6">Liste des gateaux</h6>
          <div class="col-md-6">
            <button type="button" class="btn btn-outline-info btn-sm pull-right" (click)="ajoutGateau()">
              <i class="fa fa-plus"></i>
              &nbsp;Ajouter un gateau
            </button>
          </div>
        </div>
        <div class="table-responsive">
          <table mat-table class="w-full" [dataSource]="listGateaux" matSort>

            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> ID</th>
              <td mat-cell *matCellDef="let row; let i = index"> {{i + 1}} </td>
            </ng-container>

            <ng-container matColumnDef="nb_pax">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre de PAX</th>
              <td mat-cell *matCellDef="let row"> {{row.gateau_nb_pax}} </td>
            </ng-container>

            <ng-container matColumnDef="forme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Forme</th>
              <td mat-cell *matCellDef="let row"> {{row.form}} </td>
            </ng-container>

            <ng-container matColumnDef="model">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Modèle</th>
              <td mat-cell *matCellDef="let row"> {{row.type}} </td>
            </ng-container>

            <ng-container matColumnDef="montant">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Montant</th>
              <td mat-cell *matCellDef="let row"> {{row.gateau_montant_total | number: '1.2-2':'fr'}} </td>
            </ng-container>

            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Action</th>
              <td mat-cell *matCellDef="let row; let i = index">
                <ul class="table-actions">
                  <li matTooltip="Modifier">
                    <i class="fa fa-edit"></i>
                  </li>
                  <li matTooltip="Supprimer" (click)="supprimerGateau(i)">
                    <i class="fa fa-trash-o"></i>
                  </li>
                </ul>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- Row shown when there is no matching data. -->
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell text-danger" colspan="6">Ajouter au moins un gateau pour ce commande</td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </ng-container>
  <div mat-dialog-actions class="pull-right">
    <button class="btn btn-outline-danger" mat-dialog-close>Annuler</button>
    <button type="submit" class="btn btn-outline-success ml-2" [disabled]="fg.invalid">Enregistrer</button>
  </div>
</form>
